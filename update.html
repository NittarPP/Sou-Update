@echo off
title Sou Studio - PC Speed Booster

:: If any arguments are passed, store them in _Args
set _Args=%*
if "%~1" NEQ "" (
    set _Args=%_Args:"=%
)

:: Check if script is running with admin privileges, if not, restart with admin
fltmc 1>nul 2>nul || (
    cd /d "%~dp0"
    cmd /u /c echo Set UAC = CreateObject^("Shell.Application"^) : UAC.ShellExecute "cmd.exe", "/k cd ""%~dp0"" && ""%~dpnx0"" ""%_Args%""", "", "runas", 1 > "%temp%\GetAdmin.vbs"
    "%temp%\GetAdmin.vbs"
    del /f /q "%temp%\GetAdmin.vbs" 1>nul 2>nul
    exit
)

:: Main Menu
:Menu

setlocal enabledelayedexpansion
set "VersionURL=https://nittarpp.github.io/Sou-Update/"
set "TempFile=%temp%\current_version.txt"
curl -s %VersionURL% > %TempFile%

for /f "delims=" %%i in (%TempFile%) do set "Newver=%%i"

set "Ver=0.0.2"

if %Ver% LSS %Newver% (
    echo New version available: %Newver%
) else (
    echo You have the latest version.
)

cls
echo -------------------------------------------
echo Sou Studio - PC Speed Booster
echo -------------------------------------------
echo Options:
echo 1. Clear temporary files
echo 2. Run disk cleanup
echo 3. Defragment drives (if needed)
echo 4. Check disk for errors
echo 5. Update system drivers
echo 6. Turn off all performance optimizations
echo 7. Best To Play Game
echo 8. Exit
echo -------------------------------------------
echo Other cmd
echo 9. Power Plan
echo 10. Loop Clear Temp (Press Q to stop)
echo Update
echo -------------------------------------------
if %Ver% LSS %Newver% (
    echo.
    echo New version available: %Newver% if You need New version use Update
    echo.
) else (
    echo.
    echo You have the latest version.
    echo.
)
echo.

set /p choice=Enter your choice (1-10): 

if "%choice%"=="1" (
    echo Clearing temporary files...
    del /s /f /q C:\Windows\Temp\*.* 2>nul
    del /s /f /q C:\Users\%username%\AppData\Local\Temp\*.* 2>nul
    echo Temporary files cleared.
) else if "%choice%"=="2" (
    echo Running disk cleanup...
    cleanmgr /sagerun:1
    echo Disk cleanup completed.
) else if "%choice%"=="3" (
    echo Defragmenting drives...
    defrag C: /U /V
    echo Drive defragmentation completed.
) else if "%choice%"=="4" (
    echo Checking disk for errors...
    chkdsk C: /f /r /x
    echo Disk check completed. Please restart your computer if prompted.
) else if "%choice%"=="5" (
    echo Updating system drivers...
    driverquery
    echo Driver update check completed.
) else if "%choice%"=="6" (
    echo Turning off all performance optimizations...
    reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\VisualEffects" /v VisualFXSetting /t REG_DWORD /d 2 /f
    echo All performance optimizations turned off.
) else if "%choice%"=="7" (
    echo Executing system optimizations for gaming...
    reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\VisualEffects" /v VisualFXSetting /t REG_DWORD /d 2 /f
    chkdsk C: /f /r /x
    cleanmgr /sagerun:1
    del /s /f /q C:\Windows\Temp\*.* 2>nul
    del /s /f /q C:\Users\%username%\AppData\Local\Temp\*.* 2>nul
    echo System optimizations for gaming completed.
) else if "%choice%"=="8" (
    echo Exiting Sou Studio - PC Speed Booster.
    exit /b
) else if "%choice%"=="9" (
    echo Importing Best Ultimate Performance Power Plan...
    powercfg -duplicatescheme e9a42b02-d5df-448d-aa00-03f14749eb61
    echo Deleting other power plans...
    powercfg -delete 8c5e7fda-e8bf-4a96-9a85-a6e23a8c635c
    powercfg -delete 381b4222-f694-41f0-9685-ff5bb260df2e
    powercfg -delete a1841308-3541-4fab-bc81-f71556f20b4a
    echo Cleaning up Windows Update files...
    net stop wuauserv
    net stop UsoSvc
    rd /s /q C:\Windows\SoftwareDistribution
    md C:\Windows\SoftwareDistribution
    echo Cleaning up temporary files...
    RD /S /Q %temp%
    MKDIR %temp%
    takeown /f "%temp%" /r /d y
    takeown /f "C:\Windows\Temp" /r /d y
    RD /S /Q C:\Windows\Temp
    MKDIR C:\Windows\Temp
    echo Power plan and cleanup completed.
) else if "%choice%"=="10" (
    setlocal enabledelayedexpansion
    :Loop
    del /s /f /q %userprofile%\Recent\*.*
    del /s /f /q C:\Windows\Prefetch\*.*
    del /s /f /q C:\Windows\Temp\*.*
    del /s /f /q %USERPROFILE%\appdata\local\temp\*.*
    cls
    echo -------------------------------------------------------------------
    echo                           Temp Cleaning 
    echo.
    echo                        Made By Sou Studio
    echo.
    
    set /a counter=50
    :Countdown
    if !counter! GEQ 0 (
        echo                     Time remaining: !counter! seconds
        echo.
        echo -------------------------------------------------------------------
        timeout /t 1 >nul
        set /a counter=!counter!-1
        cls
        echo -------------------------------------------------------------------
        echo                          Temp Cleaning
        echo.
        echo                        Made By Sou Studio
        echo.
        echo -------------------------------------------------------------------
        goto Countdown
    )
    
    goto Loop
) else if "%choice%"=="Update" (
    echo Update feature not yet implemented.
) else (
    echo Invalid choice. Please enter a number from 1 to 10.
)

cls
pause
goto Menu
